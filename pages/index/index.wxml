<!-- 状态栏占位 -->
<view class="status-bar" style="height: {{statusBarHeight}}px;"></view>

<!-- 顶部导航栏 -->
<view class="nav-bar" style="top: {{statusBarHeight}}px;">
  <view class="user-info">
    <image class="avatar" src="/assets/images/avatar.png" mode="aspectFill"></image>
    <text class="username">{{userInfo.nickName || '未登录'}}</text>
  </view>
  <view class="points-info">
    <text class="points-label">积分余额</text>
    <text class="points-value">{{points}}</text>
    <view class="refresh-btn" bindtap="refreshPoints">
      <text class="iconfont icon-refresh"></text>
    </view>
  </view>
</view>

<!-- 主要内容区域 -->
<view class="container" style="margin-top: 90rpx;">
  <!-- 功能区 -->
  <view class="function-grid">
    <view class="function-item" bindtap="navigateToBuyPoints">
      <view class="function-content">
        <text class="function-title">购买积分</text>
        <text class="function-desc">热销：50元=600分</text>
      </view>
    </view>
    <view class="function-item" bindtap="navigateToApiKey">
      <view class="function-content">
        <text class="function-title">API Key</text>
        <text class="function-desc">{{keyCount}}个Key使用中</text>
      </view>
    </view>
    <view class="function-item disabled" bindtap="showDocComingSoon">
      <view class="function-content">
        <text class="function-title gray-text">文档中心</text>
        <text class="function-desc gray-text">即将上线</text>
      </view>
    </view>
  </view>

  <!-- 系统公告 -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">系统公告</text>
      <text class="iconfont icon-down" bindtap="toggleNotice"></text>
    </view>
    <view class="card-content {{showNotice ? '' : 'hidden'}}">
      <view class="notice-text">
        <text class="iconfont icon-notice text-primary"></text>
        <text>新增图像生成API服务，支持多种模型，欢迎体验！</text>
      </view>
    </view>
  </view>

  <!-- API服务状态 -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">API 服务状态</text>
      <text class="iconfont icon-down" bindtap="toggleApiStatus"></text>
    </view>
    <view class="card-content {{showApiStatus ? '' : 'hidden'}}">
      <view class="status-text {{apiStatus === 'normal' ? 'text-success' : 'text-error'}}">
        <text class="iconfont {{apiStatus === 'normal' ? 'icon-success' : 'icon-error'}}"></text>
        <text>{{apiStatus === 'normal' ? '所有服务运行正常' : '部分服务异常'}}</text>
      </view>
    </view>
  </view>

  <!-- 积分消耗明细 -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">积分消耗明细</text>
      <text class="card-subtitle">最近10次</text>
    </view>
    <view class="card-content">
      <view class="history-list">
        <view wx:for="{{consumeHistory}}" wx:key="index" class="history-item">
          <view class="history-info">
            <view class="history-title">{{item.title}}</view>
            <view class="history-time">{{item.time}}</view>
          </view>
          <view class="history-points">-{{item.points}}分</view>
        </view>
      </view>
    </view>
  </view>
</view>